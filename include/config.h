/**
 * 智能桌面伴侣 - 硬件配置和全局常量定义
 * 
 * 此文件定义了所有硬件引脚配置和系统默认参数
 */

#ifndef CONFIG_H
#define CONFIG_H

#include <Arduino.h>

// ============================================================================
// I2C 引脚配置 (OLED显示屏)
// ============================================================================
#define I2C_SDA_PIN         8       // I2C数据线 - GPIO8
#define I2C_SCL_PIN         9       // I2C时钟线 - GPIO9
#define OLED_I2C_ADDRESS    0x3C    // OLED I2C地址

// ============================================================================
// 触摸传感器配置 (TTP223)
// ============================================================================
#define TOUCH_PIN           2       // 触摸传感器 - GPIO2

// ============================================================================
// I2S 音频输出配置 (MAX98357A 功放)
// ============================================================================
#define I2S_BCLK_PIN        4       // I2S 位时钟 - GPIO4
#define I2S_LRC_PIN         5       // I2S 左右声道时钟 - GPIO5
#define I2S_DOUT_PIN        3       // I2S 数据输出 - GPIO3
#define I2S_SAMPLE_RATE     44100   // 采样率
#define I2S_BITS_PER_SAMPLE 16      // 位深度
#define DEFAULT_VOLUME      80      // 默认音量 (0-100)

// ============================================================================
// I2S 麦克风配置 (INMP441)
// ============================================================================
#define I2S_MIC_SCK_PIN     4       // 麦克风时钟 (与功放共用)
#define I2S_MIC_WS_PIN      5       // 麦克风字选择 (与功放共用)
#define I2S_MIC_SD_PIN      7       // 麦克风数据输入 - GPIO7
#define MIC_SAMPLE_RATE     16000   // 麦克风采样率 (ASR推荐16kHz)
#define MIC_RECORD_SECONDS  10      // 最大录音时长 (秒)

// ============================================================================
// AI 服务配置
// ============================================================================
// ASR 语音识别 (百度语音)
#define BAIDU_ASR_URL       "https://vop.baidu.com/server_api"
#define BAIDU_TOKEN_URL     "https://aip.baidubce.com/oauth/2.0/token"

// TTS 语音合成 (百度语音)
#define BAIDU_TTS_URL       "https://tsn.baidu.com/text2audio"

// AI 大模型 (可选择不同平台)
#define AI_TIMEOUT_MS       30000   // AI 请求超时时间

// ============================================================================
// 显示配置
// ============================================================================
#define OLED_WIDTH          128     // OLED宽度（像素）
#define OLED_HEIGHT         64      // OLED高度（像素）
#define DEFAULT_BRIGHTNESS  200     // 默认亮度 (0-255)

// ============================================================================
// 触摸检测时间配置 (毫秒)
// ============================================================================
#define TOUCH_DEBOUNCE_MS       50      // 防抖时间
#define SHORT_PRESS_MAX_MS      500     // 短按最大时间
#define LONG_PRESS_MIN_MS       2000    // 长按最小时间
#define FACTORY_RESET_MIN_MS    10000   // 工厂重置最小时间

// ============================================================================
// 屏幕保护配置 (秒)
// ============================================================================
#define DEFAULT_DIM_TIMEOUT_SEC     300     // 默认调暗超时 (5分钟)
#define DEFAULT_SLEEP_TIMEOUT_SEC   600     // 默认睡眠超时 (10分钟)

// ============================================================================
// WiFi配置
// ============================================================================
#define WIFI_CONNECT_TIMEOUT_SEC    30      // WiFi连接超时时间
#define WIFI_RECONNECT_INTERVAL_MS  5000    // 重连间隔
#define WIFI_MAX_RECONNECT_ATTEMPTS 3       // 最大重连次数
#define AP_CONFIG_TIMEOUT_SEC       300     // AP配网超时 (5分钟)

// ============================================================================
// NTP时间配置
// ============================================================================
#define NTP_SERVER              "pool.ntp.org"
#define GMT_OFFSET_SEC          (8 * 3600)  // 中国时区 UTC+8
#define DAYLIGHT_OFFSET_SEC     0           // 无夏令时
#define NTP_SYNC_INTERVAL_MS    (5 * 60 * 1000)  // NTP同步间隔 (5分钟)

// ============================================================================
// 表情动画配置 (毫秒)
// ============================================================================
#define BLINK_INTERVAL_MIN_MS   3000    // 眨眼最小间隔
#define BLINK_INTERVAL_MAX_MS   8000    // 眨眼最大间隔
#define BLINK_DURATION_MS       150     // 眨眼动画持续时间
#define ANIMATION_FRAME_MS      50      // 动画帧间隔

// ============================================================================
// 系统监控配置
// ============================================================================
#define LOW_MEMORY_THRESHOLD_BYTES  10240   // 低内存警告阈值 (10KB)
#define CRITICAL_MEMORY_BYTES       5120    // 临界内存阈值 (5KB)

// ============================================================================
// 显示模式枚举
// ============================================================================
enum DisplayMode {
    MODE_FACE = 0,      // 表情模式
    MODE_CLOCK,         // 时钟模式
    MODE_SYSINFO,       // 系统信息模式
    MODE_SLEEP,         // 睡眠模式
    MODE_COUNT          // 模式总数（用于循环）
};

// ============================================================================
// 系统状态枚举
// ============================================================================
enum SystemState {
    STATE_BOOT,         // 启动中
    STATE_RUNNING,      // 正常运行
    STATE_SLEEP         // 睡眠状态
};

// ============================================================================
// 触摸事件枚举
// ============================================================================
enum TouchEvent {
    TOUCH_NONE = 0,         // 无事件
    TOUCH_SHORT,            // 短按
    TOUCH_LONG,             // 长按
    TOUCH_FACTORY_RESET     // 工厂重置
};

// ============================================================================
// 眼睛状态枚举
// ============================================================================
enum EyeState {
    EYE_NORMAL = 0,     // 正常睁眼
    EYE_BLINK,          // 眨眼中
    EYE_LOOK_LEFT,      // 看左边
    EYE_LOOK_RIGHT,     // 看右边
    EYE_SLEEP           // 闭眼睡觉
};

// ============================================================================
// 嘴巴状态枚举
// ============================================================================
enum MouthState {
    MOUTH_SMILE = 0,    // 微笑
    MOUTH_NEUTRAL,      // 中性
    MOUTH_SURPRISED,    // 惊讶
    MOUTH_TALKING       // 说话
};

// ============================================================================
// 设备配置结构体
// ============================================================================
struct DeviceConfig {
    uint8_t version;            // 配置版本号
    uint8_t brightness;         // 亮度 (0-255)
    uint16_t dimTimeoutSec;     // 调暗超时 (秒)
    uint16_t sleepTimeoutSec;   // 睡眠超时 (秒)
    uint8_t lastDisplayMode;    // 上次显示模式
};

// 默认配置
const DeviceConfig DEFAULT_CONFIG = {
    .version = 1,
    .brightness = DEFAULT_BRIGHTNESS,
    .dimTimeoutSec = DEFAULT_DIM_TIMEOUT_SEC,
    .sleepTimeoutSec = DEFAULT_SLEEP_TIMEOUT_SEC,
    .lastDisplayMode = MODE_FACE
};

#endif // CONFIG_H
